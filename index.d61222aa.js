!function(){var e=document.querySelector(".button.start"),t=document.querySelector(".button.restart"),r=document.querySelectorAll(".field-row"),a=document.querySelectorAll(".field-cell"),n=document.querySelector(".message.message-win"),i=document.querySelector(".message.message-lose"),o=document.querySelector(".message.message-start"),s=document.querySelector(".game-score");function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function d(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=new/*#__PURE__*/(function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.initialState=e.map(function(e){return d(e)}),Object.freeze(this.initialState),this.gameBoard=this.initialState.map(function(e){return d(e)}),this.status="idle",this.score=0}return e=[{key:"start",value:function(){this.status="playing",this.generateTile(2)}},{key:"restart",value:function(){this.gameBoard=this.initialState.map(function(e){return d(e)}),this.status="idle",this.score=0}},{key:"getStatus",value:function(){return this.status}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.gameBoard}},{key:"isGameBoardFull",value:function(){return this.gameBoard.flat().every(function(e){return 0!==e})}},{key:"generateTile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.isGameBoardFull())for(var t=0;t<e;t++){var r=void 0;do r=[Math.floor(4*Math.random()),Math.floor(4*Math.random())];while(0!==this.gameBoard[r[0]][r[1]])var a=.9>Math.random()?2:4;this.gameBoard[r[0]][r[1]]=a,this.checkForWin(),this.checkForLose()}}},{key:"checkForWin",value:function(){var e=!0,t=!1,r=void 0;try{for(var a,n=this.gameBoard[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var i=a.value,o=!0,s=!1,c=void 0;try{for(var d,l=i[Symbol.iterator]();!(o=(d=l.next()).done);o=!0){var u=d.value;2048===u&&(this.status="win")}}catch(e){s=!0,c=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw c}}}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}}},{key:"checkForLose",value:function(){this.canMove()||(this.status="lose")}},{key:"move",value:function(e){if("playing"===this.status){switch(e){case"left":this.moveLeft();break;case"right":this.moveRight();break;case"up":this.moveUp();break;case"down":this.moveDown()}this.checkForWin(),this.checkForLose()}}},{key:"transposeState",value:function(e){for(var t=[],r=0;r<4;r++){t[r]=[];for(var a=0;a<4;a++)t[r][a]=e[a][r]}return t}},{key:"moveLeft",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if("playing"===this.status){for(var t=!1,r=0;r<this.gameBoard.length;r++){var a=this.shiftAndMerge(this.gameBoard[r]);a.join("")!==this.gameBoard[r].join("")&&(t=!0),this.gameBoard[r]=a}return e&&t&&this.generateTile(),t}}},{key:"moveRight",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if("playing"===this.status){for(var t=!1,r=0;r<this.gameBoard.length;r++){var a=this.gameBoard[r].slice().reverse(),n=this.shiftAndMerge(a).reverse();n.join("")!==this.gameBoard[r].join("")&&(t=!0),this.gameBoard[r]=n}return e&&t&&this.generateTile(),t}}},{key:"moveUp",value:function(){if("playing"===this.status){this.gameBoard=this.transposeState(this.gameBoard);var e=this.moveLeft(!1);return this.gameBoard=this.transposeState(this.gameBoard),e&&this.generateTile(),e}}},{key:"moveDown",value:function(){if("playing"===this.status){this.gameBoard=this.transposeState(this.gameBoard);var e=this.moveRight(!1);return this.gameBoard=this.transposeState(this.gameBoard),e&&this.generateTile(),e}}},{key:"shiftAndMerge",value:function(e){for(var t=e.filter(function(e){return 0!==e}),r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,this.score+=t[r],t.splice(r+1,1));for(;t.length<4;)t.push(0);return t}},{key:"canMove",value:function(){for(var e=0;e<this.gameBoard.length;e++)for(var t=0;t<this.gameBoard[e].length;t++)if(0===this.gameBoard[e][t]||t<3&&this.gameBoard[e][t]===this.gameBoard[e][t+1]||e<3&&this.gameBoard[e][t]===this.gameBoard[e+1][t])return!0;return!1}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(t.prototype,e),t}());function u(){switch(l.getState().forEach(function(e,t){e.forEach(function(e,a){r[t].children[a].innerHTML=e||""})}),a.forEach(function(e){e.className="field-cell",e.innerHTML&&e.classList.add("field-cell--".concat(e.innerHTML))}),s.innerHTML=l.getScore(),l.getStatus()){case"win":n.classList.remove("hidden"),i.classList.add("hidden"),o.classList.add("hidden");break;case"lose":i.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden");break;case"playing":n.classList.add("hidden"),i.classList.add("hidden"),o.classList.add("hidden");break;default:o.classList.remove("hidden"),n.classList.add("hidden"),i.classList.add("hidden")}}e.addEventListener("click",function(){l.start(),e.classList.add("hidden"),t.classList.remove("hidden"),u(),document.addEventListener("keydown",f)}),t.addEventListener("click",function(){l.restart(),e.classList.remove("hidden"),t.classList.add("hidden"),u(),document.removeEventListener("keydown",f)});var h=!1;function f(e){if("playing"===l.getStatus()&&!h){switch(h=!0,e.key){case"ArrowLeft":l.moveLeft();break;case"ArrowRight":l.moveRight();break;case"ArrowUp":l.moveUp();break;case"ArrowDown":l.moveDown();break;default:h=!1;return}l.checkForWin(),l.checkForLose(),u(),"playing"!==l.getStatus()&&document.removeEventListener("keydown",f)}}document.addEventListener("keydown",f),document.addEventListener("keyup",function(){h=!1})}();
//# sourceMappingURL=index.d61222aa.js.map
